{"ast":null,"code":"import axios from'axios';import React,{useContext,useEffect,useState}from'react';import{Link}from'react-router-dom';import AppContext from'../Context/Context';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Home(_ref){let{selectedCategory}=_ref;const[product,setProduct]=useState([]);const[isErrors,setIsError]=useState(false);const{data,isError,addToCart,refreshData}=useContext(AppContext);const[imageUrls,setImageUrls]=useState({});const[isDataFetched,setIsDataFetched]=useState(false);useEffect(()=>{if(!isDataFetched){refreshData();setIsDataFetched(true);}},[refreshData,isDataFetched]);useEffect(()=>{const fetchData=async()=>{try{const response=await axios.get(\"http://localhost:8080/product\");setProduct(response.data);// Fetch images for products\nconst imageResponsePromises=response.data.map(async product=>{const imageResponse=await axios.get(\"http://localhost:8080/product/\".concat(product.id,\"/image\"),{responseType:'arraybuffer'});const blob=new Blob([imageResponse.data],{type:imageResponse.headers['content-type']});const url=URL.createObjectURL(blob);return{id:product.id,url};});// Wait for all image requests to finish and then set the imageUrls state\nconst imageUrlsArray=await Promise.all(imageResponsePromises);const imageUrlsObj=imageUrlsArray.reduce((acc,_ref2)=>{let{id,url}=_ref2;acc[id]=url;return acc;},{});setImageUrls(imageUrlsObj);}catch(error){setIsError(true);console.error('Error fetching data:',error);}};fetchData();},[]);if(isErrors){return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:\"There was an error fetching the products.\"});}// Filter products by selectedCategory\nconst filteredProducts=selectedCategory?product.filter(product=>product.category===selectedCategory):product;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:filteredProducts.length===0?/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},children:\"No Products Available\"}):filteredProducts.map(product=>{const{id,brand,name,price,available}=product;const imageUrl=imageUrls[id];// Use imageUrl from state\n// Card styles can be dynamically adjusted based on availability\nconst cardStyle={width:\"18rem\",height:\"24rem\",boxShadow:\"rgba(0, 0, 0, 0.24) 0px 2px 3px\",backgroundColor:available?\"#fff\":\"#ccc\",margin:\"10px\",display:\"flex\",flexDirection:\"column\"};return/*#__PURE__*/_jsx(\"div\",{className:\"card mb-3\",style:cardStyle,children:/*#__PURE__*/_jsxs(Link,{to:\"/productById/\".concat(id),style:{textDecoration:\"none\",color:\"inherit\"},children:[/*#__PURE__*/_jsx(\"img\",{src:imageUrl||\"/path/to/placeholder.jpg\"// Use placeholder if imageUrl is not available\n,alt:name,style:{width:\"100%\",height:\"180px\",objectFit:\"cover\",padding:\"5px\",margin:\"0\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"buttons\",style:{position:\"absolute\",top:\"25px\",left:\"220px\",zIndex:\"1\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"buttons-liked\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-heart\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",style:{flexGrow:1,display:\"flex\",flexDirection:\"column\",justifyContent:\"space-between\",padding:\"10px\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",style:{margin:\"0 0 10px 0\"},children:name.toUpperCase()}),/*#__PURE__*/_jsx(\"i\",{className:\"card-brand\",style:{fontStyle:\"italic\"},children:\"~ \"+brand})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-text\",style:{fontWeight:\"600\",margin:\"5px 0\"},children:\"$\"+price}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",style:{width:\"100%\"},onClick:e=>{e.preventDefault();addToCart(product);},disabled:!available,children:available?\"Add to Cart\":\"Out of Stock\"})]})]})]})},id);})})});}","map":{"version":3,"names":["axios","React","useContext","useEffect","useState","Link","AppContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","_ref","selectedCategory","product","setProduct","isErrors","setIsError","data","isError","addToCart","refreshData","imageUrls","setImageUrls","isDataFetched","setIsDataFetched","fetchData","response","get","imageResponsePromises","map","imageResponse","concat","id","responseType","blob","Blob","type","headers","url","URL","createObjectURL","imageUrlsArray","Promise","all","imageUrlsObj","reduce","acc","_ref2","error","console","className","children","filteredProducts","filter","category","length","style","display","justifyContent","alignItems","brand","name","price","available","imageUrl","cardStyle","width","height","boxShadow","backgroundColor","margin","flexDirection","to","textDecoration","color","src","alt","objectFit","padding","position","top","left","zIndex","flexGrow","toUpperCase","fontStyle","fontWeight","onClick","e","preventDefault","disabled"],"sources":["C:/Users/rajen/Downloads/springboot-backend/springboot-frontend/src/Page/Home.js"],"sourcesContent":["import axios from 'axios';\r\nimport React, { useContext, useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport AppContext from '../Context/Context';\r\n\r\nexport default function Home({ selectedCategory }) {\r\n  const [product, setProduct] = useState([]);\r\n  const [isErrors, setIsError] = useState(false);\r\n  const { data, isError, addToCart, refreshData } = useContext(AppContext);\r\n  const [imageUrls, setImageUrls] = useState({});\r\n  const [isDataFetched, setIsDataFetched] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isDataFetched) {\r\n      refreshData();\r\n      setIsDataFetched(true);\r\n    }\r\n  }, [refreshData, isDataFetched]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await axios.get(\"http://localhost:8080/product\");\r\n        setProduct(response.data);\r\n\r\n        // Fetch images for products\r\n        const imageResponsePromises = response.data.map(async (product) => {\r\n          const imageResponse = await axios.get(`http://localhost:8080/product/${product.id}/image`, { responseType: 'arraybuffer' });\r\n          const blob = new Blob([imageResponse.data], { type: imageResponse.headers['content-type'] });\r\n          const url = URL.createObjectURL(blob);\r\n          return { id: product.id, url };\r\n        });\r\n\r\n        // Wait for all image requests to finish and then set the imageUrls state\r\n        const imageUrlsArray = await Promise.all(imageResponsePromises);\r\n        const imageUrlsObj = imageUrlsArray.reduce((acc, { id, url }) => {\r\n          acc[id] = url;\r\n          return acc;\r\n        }, {});\r\n        setImageUrls(imageUrlsObj);\r\n\r\n      } catch (error) {\r\n        setIsError(true);\r\n        console.error('Error fetching data:', error);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  if (isErrors) {\r\n    return <div className=\"alert alert-danger\">There was an error fetching the products.</div>;\r\n  }\r\n\r\n\r\n\r\n\r\n  // Filter products by selectedCategory\r\n  const filteredProducts = selectedCategory ? product.filter((product) => product.category === selectedCategory) : product;\r\n\r\n  return (\r\n    <>\r\n      <div className=\"grid\">\r\n        {filteredProducts.length === 0 ? (\r\n          <h2\r\n            className=\"text-center\"\r\n            style={{\r\n              display: \"flex\",\r\n              justifyContent: \"center\",\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            No Products Available\r\n          </h2>\r\n        ) : (\r\n          filteredProducts.map((product) => {\r\n            const { id, brand, name, price, available } = product;\r\n            const imageUrl = imageUrls[id];  // Use imageUrl from state\r\n\r\n            // Card styles can be dynamically adjusted based on availability\r\n            const cardStyle = {\r\n              width: \"18rem\",\r\n              height: \"24rem\",\r\n              boxShadow: \"rgba(0, 0, 0, 0.24) 0px 2px 3px\",\r\n              backgroundColor: available ? \"#fff\" : \"#ccc\",\r\n              margin: \"10px\",\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n            };\r\n\r\n            return (\r\n              <div className=\"card mb-3\" style={cardStyle} key={id}>\r\n                <Link\r\n                  to={`/productById/${id}`}\r\n                  style={{ textDecoration: \"none\", color: \"inherit\" }}\r\n                >\r\n                  <img\r\n                    src={imageUrl || \"/path/to/placeholder.jpg\"}  // Use placeholder if imageUrl is not available\r\n                    alt={name}\r\n                    style={{\r\n                      width: \"100%\",\r\n                      height: \"180px\",\r\n                      objectFit: \"cover\",\r\n                      padding: \"5px\",\r\n                      margin: \"0\",\r\n                    }}\r\n                  />\r\n                  <div\r\n                    className=\"buttons\"\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      top: \"25px\",\r\n                      left: \"220px\",\r\n                      zIndex: \"1\",\r\n                    }}\r\n                  >\r\n                    <div className=\"buttons-liked\">\r\n                      <i className=\"bi bi-heart\"></i>\r\n                    </div>\r\n                  </div>\r\n                  <div\r\n                    className=\"card-body\"\r\n                    style={{\r\n                      flexGrow: 1,\r\n                      display: \"flex\",\r\n                      flexDirection: \"column\",\r\n                      justifyContent: \"space-between\",\r\n                      padding: \"10px\",\r\n                    }}\r\n                  >\r\n                    <div>\r\n                      <h5\r\n                        className=\"card-title\"\r\n                        style={{ margin: \"0 0 10px 0\" }}\r\n                      >\r\n                        {name.toUpperCase()}\r\n                      </h5>\r\n                      <i className=\"card-brand\" style={{ fontStyle: \"italic\" }}>\r\n                        {\"~ \" + brand}\r\n                      </i>\r\n                    </div>\r\n                    <div>\r\n                      <h5\r\n                        className=\"card-text\"\r\n                        style={{ fontWeight: \"600\", margin: \"5px 0\" }}\r\n                      >\r\n                        {\"$\" + price}\r\n                      </h5>\r\n                      <button\r\n                        className=\"btn btn-primary\"\r\n                        style={{ width: \"100%\" }}\r\n                        onClick={(e) => {\r\n                          e.preventDefault();\r\n                          addToCart(product);\r\n                        }}\r\n                        disabled={!available}\r\n                      >\r\n                        {available ? \"Add to Cart\" : \"Out of Stock\"}\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </Link>\r\n              </div>\r\n            );\r\n          })\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}